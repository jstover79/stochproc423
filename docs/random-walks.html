<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Random walks | Math 423 Stochastic Processes Course Notes</title>
  <meta name="description" content="Chapter 5 Random walks | Math 423 Stochastic Processes Course Notes" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Random walks | Math 423 Stochastic Processes Course Notes" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Random walks | Math 423 Stochastic Processes Course Notes" />
  
  
  

<meta name="author" content="Joseph Stover" />


<meta name="date" content="2023-01-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="random-variables-and-distributions.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script type="text/javascript">
  function unhide(divID) {
    var item = document.getElementById(divID);
    if (item) {
      item.className=(item.className=='hiddendiv')?'unhiddendiv':'hiddendiv';
    }
  }
</script> 


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stochastic Processes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introduction to R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#getting-access-to-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> Getting access to R and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#installing-and-using-packages-in-r"><i class="fa fa-check"></i><b>1.2</b> Installing and using packages in R</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#random-variables"><i class="fa fa-check"></i><b>1.3</b> Random variables</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#basics-of-programming-r-scripts"><i class="fa fa-check"></i><b>1.4</b> Basics of programming, R scripts</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#importing-datasets"><i class="fa fa-check"></i><b>1.5</b> Importing datasets</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro-stochastic-processes.html"><a href="intro-stochastic-processes.html"><i class="fa fa-check"></i><b>2</b> Intro Stochastic Processes</a>
<ul>
<li class="chapter" data-level="" data-path="intro-stochastic-processes.html"><a href="intro-stochastic-processes.html#summary-1"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html"><i class="fa fa-check"></i><b>3</b> Counting, sets, and probability basics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#ticket-in-a-box-model-of-probability"><i class="fa fa-check"></i><b>3.1</b> Ticket-in-a-box model of probability</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#sampling-from-a-box-of-tickets"><i class="fa fa-check"></i><b>3.1.1</b> Sampling from a box of tickets</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#relative-area-model-of-probability"><i class="fa fa-check"></i><b>3.2</b> Relative area model of probability</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#one-dimension"><i class="fa fa-check"></i><b>3.2.1</b> One dimension</a></li>
<li class="chapter" data-level="3.2.2" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#two-or-more-dimensions"><i class="fa fa-check"></i><b>3.2.2</b> Two or more dimensions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#sample-spaces-and-events"><i class="fa fa-check"></i><b>3.3</b> Sample Spaces and Events</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#sample-space"><i class="fa fa-check"></i><b>3.3.1</b> Sample space</a></li>
<li class="chapter" data-level="3.3.2" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#events"><i class="fa fa-check"></i><b>3.3.2</b> Events</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#set-operations"><i class="fa fa-check"></i><b>3.4</b> Set Operations</a></li>
<li class="chapter" data-level="3.5" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#venn-diagrams"><i class="fa fa-check"></i><b>3.5</b> Venn Diagrams</a></li>
<li class="chapter" data-level="3.6" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#counting-permutations-and-combinations"><i class="fa fa-check"></i><b>3.6</b> Counting, permutations, and combinations</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#multiplication-rule"><i class="fa fa-check"></i><b>3.6.1</b> Multiplication rule</a></li>
<li class="chapter" data-level="3.6.2" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#nk"><i class="fa fa-check"></i><b>3.6.2</b> <span class="math inline">\(n^k\)</span></a></li>
<li class="chapter" data-level="3.6.3" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#factorials"><i class="fa fa-check"></i><b>3.6.3</b> Factorials</a></li>
<li class="chapter" data-level="3.6.4" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#permutation"><i class="fa fa-check"></i><b>3.6.4</b> Permutation</a></li>
<li class="chapter" data-level="3.6.5" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#combination"><i class="fa fa-check"></i><b>3.6.5</b> Combination</a></li>
<li class="chapter" data-level="3.6.6" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#summary-of-counting"><i class="fa fa-check"></i><b>3.6.6</b> Summary of counting</a></li>
<li class="chapter" data-level="3.6.7" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#special-case-with-replacement-order-doesnt-matter-the-multiset"><i class="fa fa-check"></i><b>3.6.7</b> Special case: with replacement, order doesn’t matter: the multiset</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#probability"><i class="fa fa-check"></i><b>3.7</b> Probability</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#equally-likely-outcomes"><i class="fa fa-check"></i><b>3.7.1</b> Equally likely outcomes</a></li>
<li class="chapter" data-level="3.7.2" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#general-probability-theory"><i class="fa fa-check"></i><b>3.7.2</b> General probability theory</a></li>
<li class="chapter" data-level="3.7.3" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#independence"><i class="fa fa-check"></i><b>3.7.3</b> Independence</a></li>
<li class="chapter" data-level="3.7.4" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#conditional-probability"><i class="fa fa-check"></i><b>3.7.4</b> Conditional probability</a></li>
<li class="chapter" data-level="3.7.5" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#partitions"><i class="fa fa-check"></i><b>3.7.5</b> Partitions</a></li>
<li class="chapter" data-level="3.7.6" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#bayes-theorem"><i class="fa fa-check"></i><b>3.7.6</b> Baye’s Theorem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html"><i class="fa fa-check"></i><b>4</b> Random variables and distributions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#expectation-and-variance"><i class="fa fa-check"></i><b>4.1</b> Expectation and variance</a></li>
<li class="chapter" data-level="4.2" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#joint-distributions"><i class="fa fa-check"></i><b>4.2</b> Joint distributions</a></li>
<li class="chapter" data-level="4.3" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#independence-of-random-variables"><i class="fa fa-check"></i><b>4.3</b> Independence of random variables</a></li>
<li class="chapter" data-level="4.4" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#discrete-bernoulli-binomial-geometric-poisson"><i class="fa fa-check"></i><b>4.4</b> Discrete: Bernoulli, binomial, geometric, Poisson</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#bernoulli"><i class="fa fa-check"></i><b>4.4.1</b> Bernoulli</a></li>
<li class="chapter" data-level="4.4.2" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#binomial"><i class="fa fa-check"></i><b>4.4.2</b> Binomial</a></li>
<li class="chapter" data-level="4.4.3" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#geometric"><i class="fa fa-check"></i><b>4.4.3</b> Geometric</a></li>
<li class="chapter" data-level="4.4.4" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#poisson"><i class="fa fa-check"></i><b>4.4.4</b> Poisson</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#continuous-uniform-exponential-normal"><i class="fa fa-check"></i><b>4.5</b> Continuous: Uniform, exponential, normal</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#uniform"><i class="fa fa-check"></i><b>4.5.1</b> Uniform</a></li>
<li class="chapter" data-level="4.5.2" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#exponential"><i class="fa fa-check"></i><b>4.5.2</b> Exponential</a></li>
<li class="chapter" data-level="4.5.3" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#normal"><i class="fa fa-check"></i><b>4.5.3</b> Normal</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#summary-2"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="random-walks.html"><a href="random-walks.html"><i class="fa fa-check"></i><b>5</b> Random walks</a>
<ul>
<li class="chapter" data-level="5.1" data-path="random-walks.html"><a href="random-walks.html#the-simple-symmetric-random-walk-ssrw"><i class="fa fa-check"></i><b>5.1</b> The simple symmetric random walk (SSRW)</a></li>
<li class="chapter" data-level="5.2" data-path="random-walks.html"><a href="random-walks.html#distribution-of-x_n"><i class="fa fa-check"></i><b>5.2</b> Distribution of <span class="math inline">\(X_n\)</span></a></li>
<li class="chapter" data-level="5.3" data-path="random-walks.html"><a href="random-walks.html#reflection-principle"><i class="fa fa-check"></i><b>5.3</b> Reflection principle</a></li>
<li class="chapter" data-level="5.4" data-path="random-walks.html"><a href="random-walks.html#maximum-state"><i class="fa fa-check"></i><b>5.4</b> Maximum state</a></li>
<li class="chapter" data-level="5.5" data-path="random-walks.html"><a href="random-walks.html#hit-time-for-state-1"><i class="fa fa-check"></i><b>5.5</b> Hit time for state <span class="math inline">\(1\)</span></a></li>
<li class="chapter" data-level="" data-path="random-walks.html"><a href="random-walks.html#summary-3"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Math 423 Stochastic Processes Course Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="random-walks" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Random walks<a href="random-walks.html#random-walks" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The random walk will be one of our first official stochastic process models. It models a particle on a line jumping one unit left or right with equal probability. Variations of this can be used for modeling many physical phenomena, including:</p>
<ol style="list-style-type: decimal">
<li><p>a viral particle floating in the air (a 3D random walk),</p></li>
<li><p>an animal moving in its habitat (2D for most land animals, but 1D can work for a restricted habitat), or</p></li>
<li><p>a stock price (1D).</p></li>
</ol>
<div id="the-simple-symmetric-random-walk-ssrw" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> The simple symmetric random walk (SSRW)<a href="random-walks.html#the-simple-symmetric-random-walk-ssrw" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We let <span class="math inline">\(X_n\)</span> be the state of the process at time step <span class="math inline">\(n\)</span> and fix <span class="math inline">\(X_0=0\)</span> (the particle starts at the origin). The particle moves left or right with equal probability, which is given as
<span class="math display">\[P(X_{n+1}=j-1\mid X_n=j)=\frac12,\]</span>
<span class="math display">\[P(X_{n+1}=j+1\mid X_n=j)=\frac12.\]</span>
We consider the choice at each time step to go up or down as being independent of every other time step. This model is of a special class of stochastic processes called Markov chains,b ut we’ll discuss those in more detail later.</p>
<p>We can construct this model mathematically in more detail be letting the <span class="math inline">\(n^{th}\)</span> step be random variable <span class="math inline">\(Y_n\)</span> which takes values <span class="math inline">\(\pm1\)</span> with equal probability and all being independent. We say that the <span class="math inline">\(Y_n\)</span> are <strong>i.i.d. (independent and identically distributed)</strong> with <span class="math inline">\(P(Y_n=1)=P(Y_n=-1)=\frac12\)</span> for all <span class="math inline">\(n\)</span>. Independence here means that if we want to calculate probabilities for multiple <span class="math inline">\(Y_n\)</span> simultaneously, we can calculate them individually and multiply:
<span class="math display">\[P(Y_j=a,Y_k=b)=P(Y_j=a)P(Y_k=b)\]</span>
for any <span class="math inline">\(i,j\in\mathbb N\)</span> (with <span class="math inline">\(i\neq j\)</span>) and any <span class="math inline">\(a,b\in\{-1,1\}\)</span>. Then we can write
<span class="math display">\[X_n=\sum_{j=1}^n Y_j.\]</span></p>
<div class="exbox">
<p><strong>Example.</strong> Calculate <span class="math inline">\(P(X_3=3)\)</span>. This is only possible if <span class="math inline">\(Y_1=Y_2=Y_3=1\)</span> and so we calculate
<span class="math display">\[P(Y_1=1,Y_2=1,Y_3=1)=P(Y_1=1)P(Y_2=1)P(Y_3=1)=\frac12\cdot\frac12\cdot\frac12=\frac18.\]</span></p>
</div>
<div class="exbox">
<p><strong>Example.</strong> Calculate <span class="math inline">\(P(X_2=0)\)</span>. This is only possible if <span class="math inline">\(Y_1=1,Y_2=-1\)</span> or <span class="math inline">\(Y_1=-1,Y_2=1\)</span> and so we calculate each probability and add the result.
<span class="math display">\[P(X_2=0)=P(Y_1=1,Y_2=-1)+P(Y_1=-1,Y_2=1)=\frac14+\frac14=\frac12.\]</span></p>
</div>
<p>The state space of the SSRW is thus the set of integers <span class="math inline">\(\mathbb Z\)</span> and the time index set is <span class="math inline">\(\mathbb N_0\)</span>. The sample path space will be all infinitely long sequences of integers where consecutive integers only differ by <span class="math inline">\(\pm1\)</span>. We could say that the sample path space is all infinite sequences of integers, but most of those will have probability zero since any sequence which jumps outside of <span class="math inline">\(\pm1\)</span> would be considered as not possible.</p>
<p>So we have our sequence of random variables <span class="math inline">\((X_0,X_1,X_2,\ldots)\)</span>. Of course, <span class="math inline">\(X_0\)</span> is deterministically set to one, but we can still consider it a random variable with full probability mass on one. Now <span class="math inline">\(X_1\)</span> is equally likely to be <span class="math inline">\(\pm1\)</span>. If <span class="math inline">\(X_1=1\)</span>, then <span class="math inline">\(X_2\)</span> is equally likely to be <span class="math inline">\(0,2\)</span>, and if <span class="math inline">\(X_1=-1\)</span>, then <span class="math inline">\(X_2\)</span> is equally likely to be <span class="math inline">\(0,-2\)</span>.</p>
<!-- We illustrate part of the sample path space below. -->
</div>
<div id="distribution-of-x_n" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Distribution of <span class="math inline">\(X_n\)</span><a href="random-walks.html#distribution-of-x_n" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Since <span class="math inline">\(X_n\)</span> is a random sum of a bunch of plus and minus ones, we can realte it to a sum of Bernoulli random variables. If we think of flipping a fair coint <span class="math inline">\(n\)</span> times and let <span class="math inline">\(H\)</span> be the number of heads and <span class="math inline">\(T\)</span> be the number of tails, then we must have <span class="math inline">\(H+T=n\)</span>. If the <span class="math inline">\(j^{th}\)</span> coint flip is heads, we set <span class="math inline">\(Y_j=1\)</span> and if it is tails, we set <span class="math inline">\(Y_j=-1\)</span>. In this way, we can reason that <span class="math display">\[X_n=(\# \text{ heads})-(\# \text{ tails})=H-T=H-(n-H)=2H-n.\]</span>
Since we know that <span class="math inline">\(H\sim\mathsf{binom}(n,\frac12)\)</span> (<span class="math inline">\(H\)</span> is governed by the binomial distribution with <span class="math inline">\(n\)</span> trials and <span class="math inline">\(p=\frac12\)</span> probability of success), we can use this to calculate probabilities for <span class="math inline">\(X_n\)</span>:</p>
<div class="thmbox">
<p><strong>Distribution of <span class="math inline">\(X_n\)</span> for SSRW.</strong>
<span class="math display">\[P(X_n=j)=P(2H-n=j)=P\left(H=\frac{n+j}{2}\right)={n\choose \frac{n+j}{2}}\frac1{2^n}.\]</span></p>
</div>
<p>Now we refresh the normal approximation to the binomial.</p>
<div class="defbox">
<p><strong>Normal approximation to binomial.</strong>
Let <span class="math inline">\(X\sim\mathsf{binom}(n,p)\)</span>, then for <span class="math inline">\(n\)</span> large (usually <span class="math inline">\(n\geq 30\)</span> with <span class="math inline">\(np\geq5\)</span> and <span class="math inline">\(n(1-p)\geq5\)</span> is acceptable, but it might still be a rough approximation). Then we can say that
<span class="math display">\[X\overset{\small approx}{\sim} \mathsf{N}(\mu=np,\sigma^2=np(1-p)).\]</span></p>
</div>
<p>The binomial is a discrete distribution, but the normal is a continuous distribution. Any time we use a continuous distribution to approximate a discrete distribution, it might be useful to use a <strong>continuity correction</strong>.</p>
<!-- ::: defbox -->
<p><strong>Continuity correction.</strong>
If discrete random variable <span class="math inline">\(X\)</span> has values <span class="math inline">\(x_1,x_2,\ldots\)</span> and we wish to approximate <span class="math inline">\(P(X=x_j)\)</span> by continuous random variable <span class="math inline">\(Y\)</span>, then we can integrate the probability density function of <span class="math inline">\(Y\)</span> from halfway to the next <span class="math inline">\(x\)</span>-values on the left and right:
<span class="math display">\[P(X=x_j)\approx P(x_j-(x_j-x_{j-1})/2 &lt; Y \leq x_j+(x_j-x_{j-1})/2).\]</span>
For the normal approximation to the binomial random variable <span class="math inline">\(X\sim binom(n,p)\)</span>, this translates to using <span class="math inline">\(Y\sim N(np,np(1-p))\)</span> and
<span class="math display">\[P(X=k)\approx P\left(k-\frac12 &lt; Y \leq k+\frac12\right).\]</span>
<!-- ::: --></p>
<!-- ::: thmbox -->
<p><strong>Normal approximation to distribution of <span class="math inline">\(X_n\)</span> for SSRW.</strong>
We have that
<span class="math display">\[P(X_n=j)=P(2H-n=j)=P\left(H=\frac{n+j}{2}\right)\]</span>
and that <span class="math inline">\(H\)</span> is binomial distributed with parameters <span class="math inline">\(n,p\)</span> and hence is approximately normally distributed with mean <span class="math inline">\(\mu=np\)</span> and variance <span class="math inline">\(\sigma^2=np(1-p)\)</span>. Now we can then write
<span class="math display">\[P(X_n=j)=P(2H-n=j)=P\left(H=\frac{n+j}{2}\right)\approx P\left(\frac{n+j}{2}-\frac12&lt;Y\leq \frac{n+j}{2}+\frac12\right)\]</span>
where <span class="math inline">\(Y\sim\mathsf N(\mu=np,\sigma^2=np(1-p))\)</span>.</p>
<p>In R we can calculate normal cumulative probabilities using <code>pnorm()</code>, so the above probability for <span class="math inline">\(P(X_n=j)\)</span> is given by the R code (with the continuity correction)
<!-- $$P(X_n=j)=\texttt{pnorm((n+j)/2+1/2,n*p,sqrt(n*p*(1-p)))-pnorm((n+j)/2-1/2,n*p,sqrt(n*p*(1-p)))}}$$ -->
<!-- $$P(X_n=j)=$$ --></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="random-walks.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>((n<span class="sc">+</span>j)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,<span class="at">mean=</span>n<span class="sc">*</span>p,<span class="at">sd=</span><span class="fu">sqrt</span>(n<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)))<span class="sc">-</span><span class="fu">pnorm</span>((n<span class="sc">+</span>j)<span class="sc">/</span><span class="dv">2-1</span><span class="sc">/</span><span class="dv">2</span>,<span class="at">mean=</span>n<span class="sc">*</span>p,<span class="at">sd=</span><span class="fu">sqrt</span>(n<span class="sc">*</span>p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)))</span></code></pre></div>
<!-- ::: -->
<div class="exbox">
<p><strong>Example.</strong> Let’s calculate <span class="math inline">\(P(X_7=-3)\)</span>. We have <span class="math inline">\(n=7\)</span>, <span class="math inline">\(p=0.5\)</span>, and <span class="math inline">\(j=-3\)</span>. The exact calculation using the distribution we derived from the bionomial is:
<span class="math display">\[P(X_7=-3)={7\choose\frac{7-3}{2}}\frac1{2^7}={7\choose2}\frac1{2^7}=\frac{7\cdot 3}{2^7}\approx0.1640625.\]</span>
And using the normal approximation (with continuity correction) we get:
<span class="math inline">\(P(X_7=-3)\approx\)</span><code>pnorm(2.5,7/2,sqrt(7)/2)-pnorm(1.5,7/2,sqrt(7)/2)</code><span class="math inline">\(\approx0.1595609\)</span> which is a reasonable approximation.</p>
</div>
<p>We can make the R code a bit simpler though.</p>
<!-- ::: thmbox -->
<p>If <span class="math inline">\(X\sim N(\mu\sigma^2)\)</span> then <span class="math inline">\(aX+b\sim N(a\mu+b,a^2\sigma^2)\)</span>. This means that <span class="math inline">\(aX+b\)</span> is a normal random variable as well with <span class="math inline">\(E(aX+b)=a\mu+b\)</span> and <span class="math inline">\(Var(aX+b=a^2\sigma^2)\)</span>. Since we are approximating <span class="math inline">\(H\)</span>, the number of up steps, as a normal random variable, then <span class="math inline">\(2H-n\)</span> is also approximately normally distributed.
<span class="math display">\[X_n=2H-n\overset{\small approx}{\sim}\mathsf{N}(\mu=2np-n,\sigma^2=4np(1-p)).\]</span>
And for the SSRW this means
<span class="math display">\[X_n=2H-n\overset{\small approx}{\sim}\mathsf{N}(\mu=0,\sigma^2=n).\]</span>
Now to apply the continuity correction is a bit trickier though, because <span class="math inline">\(X_n\)</span> only takes on values <span class="math inline">\(-n,-n+2,\ldots,n-2,n\)</span>. Instead of adding and subtracting <span class="math inline">\(\frac12\)</span>, we must add and subtract <span class="math inline">\(1\)</span> and <span class="math inline">\(P(X_n=j)\)</span> is approximated by <code>pnorm(j+1,0,sqrt(n))-pnorm(j-1,0,sqrt(n))</code>.</p>
<!-- ::: -->
</div>
<div id="reflection-principle" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Reflection principle<a href="random-walks.html#reflection-principle" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we’ll look at a property of the sample path space which will help us understand a few more properties for the random walk. Consider some state <span class="math inline">\(m\)</span> which we are interested in the RW hitting at some time step <span class="math inline">\(n=0,1,2,\ldots,k\)</span>. Clearly we must consider <span class="math inline">\(m\)</span> between <span class="math inline">\(-k\)</span> and <span class="math inline">\(k\)</span> since the RW can only go that far in <span class="math inline">\(k\)</span> time steps.</p>
</div>
<div id="maximum-state" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Maximum state<a href="random-walks.html#maximum-state" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="hit-time-for-state-1" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Hit time for state <span class="math inline">\(1\)</span><a href="random-walks.html#hit-time-for-state-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!-- ## RW2 -->
<!-- ::: exbox -->
<!-- **Example.** -->
<!-- here is an example problem... -->
<!-- <details> -->
<!-- <summary> -->
<!-- show/hide solution -->
<!-- </summary> -->
<!-- Here is the solution, we use the following theorem: -->
<!-- ::: thmbox -->
<!-- **Theorem.** Here is a hidden theorem... -->
<!-- ::: -->
<!-- and that solves it! -->
<!-- </details> -->
<!-- ::: -->
</div>
<div id="summary-3" class="section level2 unnumbered hasAnchor">
<h2>Summary<a href="random-walks.html#summary-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="defbox">
<p><strong>Summary of notation, formulas, and terminology</strong></p>
<p>For <span class="math inline">\(X_n\)</span> the simple 1D random walk with <span class="math inline">\(p\)</span> probability of an up step:</p>
<p><span class="math inline">\(P(X_n=j)={n\choose (n+j)/2}p^{(n+j)/2}(1-p)^{(n-j)/2}\)</span><br>
    For SSRW: <span class="math inline">\(P(X_n=j)={n\choose (n+j)/2}\frac1{2^n}\)</span></p>
<p><span class="math inline">\(P(X_n=j)\approx\)</span><code>pnorm(j+1,2*n*p-n,sqrt(4*n*p*(1-p)))-pnorm(j-1,2*n*p-n,sqrt(4*n*p*(1-p)))</code><br>
    For SSRW: <span class="math inline">\(P(X_n=j)\approx\)</span><code>pnorm(j+1,0,sqrt(n)-pnorm(j-1,0,sqrt(n))</code><br></p>
<p><span class="math inline">\(P(T_1=2k+1)=\frac1{k+1}{2k\choose k}\frac1{2^{2k+1}}\)</span>, <span class="math inline">\(T_1=~\)</span>first time SSRW (<span class="math inline">\(p=\frac12\)</span>) to hit state <span class="math inline">\(1\)</span></p>
<p><span class="math inline">\(P(T_1=2k+1)=\frac1{k+1}{2k\choose k}p^{k+1}(1-p)^k\)</span>, <span class="math inline">\(T_1=~\)</span>first time SARW (any <span class="math inline">\(p\in[0,1]\)</span>) to hit state <span class="math inline">\(1\)</span></p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="random-variables-and-distributions.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jstover79/stochproc423/edit/master/05-rand-walk.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jstover79/stochproc423/blob/master/05-rand-walk.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
