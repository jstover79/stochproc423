<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Conditional expectation | Math 423 Stochastic Processes Course Notes</title>
  <meta name="description" content="Chapter 4 Conditional expectation | Math 423 Stochastic Processes Course Notes" />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Conditional expectation | Math 423 Stochastic Processes Course Notes" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Conditional expectation | Math 423 Stochastic Processes Course Notes" />
  
  
  

<meta name="author" content="Joseph Stover" />


<meta name="date" content="2023-04-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="random-variables-and-distributions.html"/>
<link rel="next" href="intro-stochastic-processes.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script type="text/javascript">
  function unhide(divID) {
    var item = document.getElementById(divID);
    if (item) {
      item.className=(item.className=='hiddendiv')?'unhiddendiv':'hiddendiv';
    }
  }
</script> 


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Stochastic Processes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>1</b> Introduction to R and RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#getting-access-to-r-and-rstudio"><i class="fa fa-check"></i><b>1.1</b> Getting access to R and RStudio</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#r-basics"><i class="fa fa-check"></i><b>1.2</b> R basics</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#data-structures-vectors-matrices"><i class="fa fa-check"></i><b>1.2.1</b> Data structures, vectors, matrices</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#installing-and-using-packages-in-r"><i class="fa fa-check"></i><b>1.3</b> Installing and using packages in R</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#random-variables"><i class="fa fa-check"></i><b>1.4</b> Random variables</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#basics-of-programming-r-scripts"><i class="fa fa-check"></i><b>1.5</b> Basics of programming, R scripts</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#importing-datasets-into-r"><i class="fa fa-check"></i><b>1.6</b> Importing datasets into R</a></li>
<li class="chapter" data-level="" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html"><i class="fa fa-check"></i><b>2</b> Counting, sets, and probability basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#ticket-in-a-box-model-of-probability"><i class="fa fa-check"></i><b>2.1</b> Ticket-in-a-box model of probability</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#sampling-from-a-box-of-tickets"><i class="fa fa-check"></i><b>2.1.1</b> Sampling from a box of tickets</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#relative-area-model-of-probability"><i class="fa fa-check"></i><b>2.2</b> Relative area model of probability</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#one-dimension"><i class="fa fa-check"></i><b>2.2.1</b> One dimension</a></li>
<li class="chapter" data-level="2.2.2" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#two-or-more-dimensions"><i class="fa fa-check"></i><b>2.2.2</b> Two or more dimensions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#sample-spaces-and-events"><i class="fa fa-check"></i><b>2.3</b> Sample Spaces and Events</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#sample-space"><i class="fa fa-check"></i><b>2.3.1</b> Sample space</a></li>
<li class="chapter" data-level="2.3.2" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#events"><i class="fa fa-check"></i><b>2.3.2</b> Events</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#set-operations"><i class="fa fa-check"></i><b>2.4</b> Set Operations</a></li>
<li class="chapter" data-level="2.5" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#venn-diagrams"><i class="fa fa-check"></i><b>2.5</b> Venn Diagrams</a></li>
<li class="chapter" data-level="2.6" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#counting-permutations-and-combinations"><i class="fa fa-check"></i><b>2.6</b> Counting, permutations, and combinations</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#multiplication-rule"><i class="fa fa-check"></i><b>2.6.1</b> Multiplication rule</a></li>
<li class="chapter" data-level="2.6.2" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#nk"><i class="fa fa-check"></i><b>2.6.2</b> <span class="math inline">\(n^k\)</span></a></li>
<li class="chapter" data-level="2.6.3" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#factorials"><i class="fa fa-check"></i><b>2.6.3</b> Factorials</a></li>
<li class="chapter" data-level="2.6.4" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#permutation"><i class="fa fa-check"></i><b>2.6.4</b> Permutation</a></li>
<li class="chapter" data-level="2.6.5" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#combination"><i class="fa fa-check"></i><b>2.6.5</b> Combination</a></li>
<li class="chapter" data-level="2.6.6" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#summary-of-counting"><i class="fa fa-check"></i><b>2.6.6</b> Summary of counting</a></li>
<li class="chapter" data-level="2.6.7" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#special-case-with-replacement-order-doesnt-matter-the-multiset"><i class="fa fa-check"></i><b>2.6.7</b> Special case: with replacement, order doesn’t matter: the multiset</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#probability"><i class="fa fa-check"></i><b>2.7</b> Probability</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#equally-likely-outcomes"><i class="fa fa-check"></i><b>2.7.1</b> Equally likely outcomes</a></li>
<li class="chapter" data-level="2.7.2" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#general-probability-theory"><i class="fa fa-check"></i><b>2.7.2</b> General probability theory</a></li>
<li class="chapter" data-level="2.7.3" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#independence"><i class="fa fa-check"></i><b>2.7.3</b> Independence</a></li>
<li class="chapter" data-level="2.7.4" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#conditional-probability"><i class="fa fa-check"></i><b>2.7.4</b> Conditional probability</a></li>
<li class="chapter" data-level="2.7.5" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#partitions"><i class="fa fa-check"></i><b>2.7.5</b> Partitions</a></li>
<li class="chapter" data-level="2.7.6" data-path="counting-sets-and-probability-basics.html"><a href="counting-sets-and-probability-basics.html#bayes-theorem"><i class="fa fa-check"></i><b>2.7.6</b> Baye’s Theorem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html"><i class="fa fa-check"></i><b>3</b> Random variables and distributions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#expectation-and-variance"><i class="fa fa-check"></i><b>3.1</b> Expectation and variance</a></li>
<li class="chapter" data-level="3.2" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#joint-distributions"><i class="fa fa-check"></i><b>3.2</b> Joint distributions</a></li>
<li class="chapter" data-level="3.3" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#independence-of-random-variables"><i class="fa fa-check"></i><b>3.3</b> Independence of random variables</a></li>
<li class="chapter" data-level="3.4" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#discrete-bernoulli-binomial-geometric-poisson"><i class="fa fa-check"></i><b>3.4</b> Discrete: Bernoulli, binomial, geometric, Poisson</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#bernoulli"><i class="fa fa-check"></i><b>3.4.1</b> Bernoulli</a></li>
<li class="chapter" data-level="3.4.2" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#binomial"><i class="fa fa-check"></i><b>3.4.2</b> Binomial</a></li>
<li class="chapter" data-level="3.4.3" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#geometric"><i class="fa fa-check"></i><b>3.4.3</b> Geometric</a></li>
<li class="chapter" data-level="3.4.4" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#poisson"><i class="fa fa-check"></i><b>3.4.4</b> Poisson</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#continuous-uniform-exponential-normal"><i class="fa fa-check"></i><b>3.5</b> Continuous: Uniform, exponential, normal</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#uniform"><i class="fa fa-check"></i><b>3.5.1</b> Uniform</a></li>
<li class="chapter" data-level="3.5.2" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#exponential"><i class="fa fa-check"></i><b>3.5.2</b> Exponential</a></li>
<li class="chapter" data-level="3.5.3" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#normal"><i class="fa fa-check"></i><b>3.5.3</b> Normal</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="random-variables-and-distributions.html"><a href="random-variables-and-distributions.html#summary-1"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="conditional-expectation.html"><a href="conditional-expectation.html"><i class="fa fa-check"></i><b>4</b> Conditional expectation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="conditional-expectation.html"><a href="conditional-expectation.html#conditional-distributions"><i class="fa fa-check"></i><b>4.1</b> Conditional distributions</a></li>
<li class="chapter" data-level="4.2" data-path="conditional-expectation.html"><a href="conditional-expectation.html#conditional-expectation-1"><i class="fa fa-check"></i><b>4.2</b> Conditional expectation</a></li>
<li class="chapter" data-level="4.3" data-path="conditional-expectation.html"><a href="conditional-expectation.html#random-conditional-expectation"><i class="fa fa-check"></i><b>4.3</b> (Random) conditional expectation</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="conditional-expectation.html"><a href="conditional-expectation.html#total-expectation"><i class="fa fa-check"></i><b>4.3.1</b> Total expectation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="conditional-expectation.html"><a href="conditional-expectation.html#summary-2"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="intro-stochastic-processes.html"><a href="intro-stochastic-processes.html"><i class="fa fa-check"></i><b>5</b> Intro Stochastic Processes</a>
<ul>
<li class="chapter" data-level="" data-path="intro-stochastic-processes.html"><a href="intro-stochastic-processes.html#summary-3"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="random-walks.html"><a href="random-walks.html"><i class="fa fa-check"></i><b>6</b> Random walks</a>
<ul>
<li class="chapter" data-level="6.1" data-path="random-walks.html"><a href="random-walks.html#the-simple-symmetric-random-walk-ssrw"><i class="fa fa-check"></i><b>6.1</b> The simple symmetric random walk (SSRW)</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="random-walks.html"><a href="random-walks.html#definition-of-a-random-walk"><i class="fa fa-check"></i><b>6.1.1</b> Definition of a random walk</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="random-walks.html"><a href="random-walks.html#distribution-of-x_n"><i class="fa fa-check"></i><b>6.2</b> Distribution of <span class="math inline">\(X_n\)</span></a></li>
<li class="chapter" data-level="6.3" data-path="random-walks.html"><a href="random-walks.html#shift-invariance-memorylessness"><i class="fa fa-check"></i><b>6.3</b> Shift invariance &amp; memorylessness</a></li>
<li class="chapter" data-level="6.4" data-path="random-walks.html"><a href="random-walks.html#reflection-principle"><i class="fa fa-check"></i><b>6.4</b> Reflection principle</a></li>
<li class="chapter" data-level="6.5" data-path="random-walks.html"><a href="random-walks.html#maximum-state-reached"><i class="fa fa-check"></i><b>6.5</b> Maximum state reached</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="random-walks.html"><a href="random-walks.html#maximum-over-infinite-sample-paths-for-p12"><i class="fa fa-check"></i><b>6.5.1</b> Maximum over infinite sample paths for <span class="math inline">\(p&lt;1/2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="random-walks.html"><a href="random-walks.html#hitting-times"><i class="fa fa-check"></i><b>6.6</b> Hitting times</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="random-walks.html"><a href="random-walks.html#hitting-time-for-state-1"><i class="fa fa-check"></i><b>6.6.1</b> Hitting time for state <span class="math inline">\(1\)</span></a></li>
<li class="chapter" data-level="6.6.2" data-path="random-walks.html"><a href="random-walks.html#hitting-time-for-other-states"><i class="fa fa-check"></i><b>6.6.2</b> Hitting time for other states</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="random-walks.html"><a href="random-walks.html#return-time-to-state-0"><i class="fa fa-check"></i><b>6.7</b> Return time to state <span class="math inline">\(0\)</span></a></li>
<li class="chapter" data-level="" data-path="random-walks.html"><a href="random-walks.html#summary-4"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="limit-theorems.html"><a href="limit-theorems.html"><i class="fa fa-check"></i><b>7</b> Limit theorems</a>
<ul>
<li class="chapter" data-level="7.1" data-path="limit-theorems.html"><a href="limit-theorems.html#inequalities"><i class="fa fa-check"></i><b>7.1</b> Inequalities</a></li>
<li class="chapter" data-level="7.2" data-path="limit-theorems.html"><a href="limit-theorems.html#law-of-large-numbers"><i class="fa fa-check"></i><b>7.2</b> Law of large numbers</a></li>
<li class="chapter" data-level="7.3" data-path="limit-theorems.html"><a href="limit-theorems.html#central-limit-theorem"><i class="fa fa-check"></i><b>7.3</b> Central limit theorem</a></li>
<li class="chapter" data-level="7.4" data-path="limit-theorems.html"><a href="limit-theorems.html#borel-cantelli"><i class="fa fa-check"></i><b>7.4</b> Borel-Cantelli</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="markov-chains.html"><a href="markov-chains.html"><i class="fa fa-check"></i><b>8</b> Markov Chains</a>
<ul>
<li class="chapter" data-level="8.1" data-path="markov-chains.html"><a href="markov-chains.html#graph-of-a-markov-chain"><i class="fa fa-check"></i><b>8.1</b> Graph of a Markov chain</a></li>
<li class="chapter" data-level="8.2" data-path="markov-chains.html"><a href="markov-chains.html#classification-of-states"><i class="fa fa-check"></i><b>8.2</b> Classification of states</a></li>
<li class="chapter" data-level="8.3" data-path="markov-chains.html"><a href="markov-chains.html#distribution-at-time-n"><i class="fa fa-check"></i><b>8.3</b> Distribution at time <span class="math inline">\(n\)</span></a></li>
<li class="chapter" data-level="8.4" data-path="markov-chains.html"><a href="markov-chains.html#simulating-a-markov-chain-in-r"><i class="fa fa-check"></i><b>8.4</b> Simulating a Markov chain in R</a></li>
<li class="chapter" data-level="8.5" data-path="markov-chains.html"><a href="markov-chains.html#return-times-and-hitting-probabilities"><i class="fa fa-check"></i><b>8.5</b> Return times and hitting probabilities</a></li>
<li class="chapter" data-level="8.6" data-path="markov-chains.html"><a href="markov-chains.html#limiting-probabilities"><i class="fa fa-check"></i><b>8.6</b> Limiting probabilities</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="markov-chains.html"><a href="markov-chains.html#limiting-distributions"><i class="fa fa-check"></i><b>8.6.1</b> Limiting distributions</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="markov-chains.html"><a href="markov-chains.html#stationary-distributions"><i class="fa fa-check"></i><b>8.7</b> Stationary distributions</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="markov-chains.html"><a href="markov-chains.html#stationary-distributions-for-reducible-chains"><i class="fa fa-check"></i><b>8.7.1</b> Stationary distributions for reducible chains</a></li>
<li class="chapter" data-level="8.7.2" data-path="markov-chains.html"><a href="markov-chains.html#r-code-for-finding-stationary-distributions"><i class="fa fa-check"></i><b>8.7.2</b> R code for finding stationary distributions</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="markov-chains.html"><a href="markov-chains.html#probability-of-absorption-time-to-absorption"><i class="fa fa-check"></i><b>8.8</b> Probability of absorption &amp; time to absorption</a></li>
<li class="chapter" data-level="8.9" data-path="markov-chains.html"><a href="markov-chains.html#gamblers-ruin"><i class="fa fa-check"></i><b>8.9</b> Gambler’s ruin</a></li>
<li class="chapter" data-level="" data-path="markov-chains.html"><a href="markov-chains.html#summary-5"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Math 423 Stochastic Processes Course Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="conditional-expectation" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Conditional expectation<a href="conditional-expectation.html#conditional-expectation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Now we discuss the concept of conditional expectation. Conditioning can be thought of as reducing the number of possibilities for a random experiment.</p>
<div id="conditional-distributions" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Conditional distributions<a href="conditional-expectation.html#conditional-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The conditional distribution of <span class="math inline">\(X\)</span> given <span class="math inline">\(Y=y\)</span> is given as <span class="math display">\[f_{X|Y=y}(x|y)=\frac{f_{X,Y}(x,y)}{f_Y(y)}\]</span>
where <span class="math inline">\(f_{X,Y}\)</span> is the joint distribution of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> and <span class="math inline">\(f_Y\)</span> is the marginal distribution of <span class="math inline">\(Y\)</span>. If both are discrete random variables, then these are all probability mass functions (and we sum to get probabilities), and if they are both continuous random variables, then all are probability density functions (and we integrate to get probabilities).</p>
<p>For the discrete case, which is what we will mostly be working with, we get
<span class="math display">\[f_{X|Y=y}(x|y)=\frac{f_{X,Y}(x,y)}{f_Y(y)}=\frac{P(X=x,Y=y)}{P(Y=y)}=P(X=x\mid Y=y).\]</span>
So the conditional pmf is just another way to write conditional probabilities. We can calculate conditional pmfs from the tabular format of the joint distribution simply by dividing a row or column by its total sum. Consider the example below.</p>
<!-- ```{r, echo=FALSE, message=FALSE} -->
<!-- library(knitr) -->
<!-- library(tidyverse) -->
<!-- library(kableExtra) -->
<!-- df <- data.frame(x = 1:10, y = 11:20) -->
<!-- kable(df, format = "html", table.attr = "style='width:30%;'") -->
<!-- kable(df, format = "html", table.attr = "style='width:30%;'") %>%  -->
<!--   kableExtra::kable_styling() -->
<!-- ``` -->
<table>
<thead>
<tr class="header">
<th></th>
<th></th>
<th></th>
<th>X</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td>0</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>Y</td>
<td>1</td>
<td>0.36</td>
<td>0.18</td>
<td>0.06</td>
</tr>
<tr class="odd">
<td></td>
<td>2</td>
<td>0.14</td>
<td>0.20</td>
<td>0.06</td>
</tr>
</tbody>
</table>
<p>We can write the conditional pmf for <span class="math inline">\(X\)</span> given <span class="math inline">\(Y=1\)</span> by taking the row <span class="math inline">\((0.36,0.18,0.06)\)</span> and dividing it by its sum <span class="math inline">\(0.36+0.18+0.06=0.60=P(Y=1)\)</span> to get <span class="math inline">\((0.36/0.6,0.18/0.6,0.06/0.6)=(0.6,0.3,0.1)\)</span>, and this is exactly the conditional pmf for <span class="math inline">\(X\)</span> given <span class="math inline">\(Y=1\)</span>.</p>
<p><span class="math display">\[f_{X|Y=5}=\begin{cases}
0.6 &amp; \text{ if } x=0\\
0.3 &amp; \text{ if } x=1\\
0.1 &amp; \text{ if } x=2\\
\end{cases}\]</span></p>
</div>
<div id="conditional-expectation-1" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Conditional expectation<a href="conditional-expectation.html#conditional-expectation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Conditional expectation can be thought of in the following way. Imagine that we perform an experiment repeatedly where each outcome gives us two measurements, i.e. two random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> which could depend on each other in any arbitrary way. In other words a single outcome of the experiment gives us a pair <span class="math inline">\((X,Y)\)</span>. We could simply average the <span class="math inline">\(X\)</span>-values to approximate its mean <span class="math inline">\(E(X)\)</span>, or we could average only those <span class="math inline">\(X\)</span> values which came paired with a particular <span class="math inline">\(Y\)</span> value or a predetermined range of <span class="math inline">\(Y\)</span>-values. This would be calculating a conditional expected value for <span class="math inline">\(X\)</span>.</p>
<p>If we average all <span class="math inline">\(X\)</span>-values that are paired with precisely <span class="math inline">\(Y=y\)</span>, then this gives us an estimate of <span class="math inline">\(E(X\mid Y=y)\)</span> the <strong>conditional expectation of <span class="math inline">\(X\)</span> given <span class="math inline">\(Y=y\)</span></strong>. We can compute this from our distributions just as we did before for expected value, but we use the conditional pmf:
<span class="math display">\[E(X\mid Y=y)=\sum_x x f_{X|Y=y}(x|y).\]</span></p>
<p>It is advised to first think of <span class="math inline">\(y\)</span> as a fixed constant in the above equation. But one can also consider it as a variable <span class="math inline">\(y\)</span> (a standard algebra/calculus variable, not a random variable) which ranges over the set of possible values for random variable <span class="math inline">\(Y\)</span>. In other words <span class="math inline">\(E(X\mid Y=y)\)</span> can be though of as a <em>function of <span class="math inline">\(y\)</span></em> in the typical algebra/calculus sense, i.e. <span class="math inline">\(E(X\mid Y=y)=h(y)\)</span> with plugging in a specific <span class="math inline">\(y\)</span>-value will output the fixed numerical conditional expectation of <span class="math inline">\(X\)</span>.</p>
<p>In the continuous case, we integrate instead of sum:
<span class="math display">\[E(X\mid Y=y)=\int_{-\infty}^\infty x f_{X|Y=y}(x|y) ~dx.\]</span>
In this case, we are working with probability densities though, so the conditional pdf is not the same thing as conditional probability.</p>
</div>
<div id="random-conditional-expectation" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> (Random) conditional expectation<a href="conditional-expectation.html#random-conditional-expectation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can also write <span class="math inline">\(E(X\mid Y)\)</span> without specifying a particular value for <span class="math inline">\(Y\)</span> and leaving it as a random variable. If we were to decide that we are interested in a particular <span class="math inline">\(Y\)</span>-values, e.g. <span class="math inline">\(y\)</span>, then we can plug that in to get <span class="math inline">\(E(X\mid Y=y)\)</span> which we can calculate as already discussed and can think of as a function <span class="math inline">\(E(X\mid Y=y)=h(y)\)</span>.</p>
<p>We can skip the step of plugging in a particular <span class="math inline">\(y\)</span> though and can just write <span class="math inline">\(E(X\mid Y)=h(Y)\)</span> which is a function of random variable <span class="math inline">\(Y\)</span>. Since a function of a random variable is also a random variable, we have that <span class="math inline">\(E(X\mid Y)\)</span> is a random variable. This means that we can calculate probabilities such as <span class="math inline">\(P[E(X\mid Y)=a]\)</span> or <span class="math inline">\(P\left[E(X\mid Y)\leq b\right]\)</span>. In fact, these probabilities are really qustions about the random variable <span class="math inline">\(Y\)</span>:
<span class="math display">\[P[E(X\mid Y)=a]=P\left[ Y \text{ gives a value } y \text{ that results in} E(X\mid Y=y)=a\right]\]</span>
Consider the example below.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th></th>
<th></th>
<th>X</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td>0</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>Y</td>
<td>1</td>
<td>0.36</td>
<td>0.18</td>
<td>0.06</td>
</tr>
<tr class="odd">
<td></td>
<td>2</td>
<td>0.14</td>
<td>0.20</td>
<td>0.06</td>
</tr>
</tbody>
</table>
<p>We can calculate the conditional pmfs <span class="math inline">\(f_{X|Y=1}(x|1)\)</span> and <span class="math inline">\(f_{X|Y=2}(x|2)\)</span>, and from these we can calculate <span class="math inline">\(E(X\mid Y=1)\)</span> and <span class="math inline">\(E(X\mid Y=2)\)</span>.</p>
<p><span class="math display">\[\begin{aligned}
E(X\mid Y=1)&amp;=0\cdot f_{X|Y=1}(0|1)+1\cdot f_{X|Y=1}(1|1)+2\cdot f_{X|Y=1}(2|1)\\
&amp;=0\cdot \frac{0.36}{0.6}+1\cdot \frac{0.18}{0.6}+2\cdot \frac{0.06}{0.6}=0.3+0.2=0.5
\end{aligned}\]</span>
Similarly, we get <span class="math inline">\(E(X\mid Y=2)=0.2/0.2+2\cdot 0.06/0.2=1.6\)</span>.</p>
<p>Hence we get the function
<span class="math display">\[
E(X\mid Y=y)=h(y)=
\begin{cases}
0.5 &amp;\text{ if } y=1\\
1.6 &amp;\text{ if } y=2.
\end{cases}
\]</span>
As a random variable, we get
<span class="math display">\[
P[E(X\mid Y)=a]=
\begin{cases}
P(Y=1) &amp;\text{ if } a=0.5\\
P(Y=2) &amp;\text{ if } a=1.6.
\end{cases}
\]</span>
So we can write down the pmf for <span class="math inline">\(E(X\mid Y)=h(Y)\)</span> as
<span class="math display">\[
f_{h(Y)}(a)=f_{E(X\mid Y)}(a)=
\begin{cases}
0.6 &amp;\text{ if } a=0.5\\
0.4 &amp;\text{ if } a=1.6.
\end{cases}
\]</span></p>
<div id="total-expectation" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Total expectation<a href="conditional-expectation.html#total-expectation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can compute the expected value of a random variable using conditioning.</p>
<p><span class="math display">\[
\begin{aligned}
E(X)&amp;=E[E(X\mid Y)]\\
&amp;=\sum_y E(X\mid Y=y) P(Y=y)\\
\end{aligned}\]</span></p>
<div class="exbox">
<p><strong>Example.</strong>
Consider the example where <span class="math inline">\(Y\sim\textsf{unif}(1,5)\)</span> and, conditional on <span class="math inline">\(Y=y\)</span>, <span class="math inline">\(X\sim\textsf{Exp(rate=\)</span>y<span class="math inline">\()}\)</span>. Calculate <span class="math inline">\(E(X)\)</span>.</p>
<p><em>Solution:</em> What we have here is called a <strong>compound distribution</strong> since the distribution of <span class="math inline">\(X\)</span> has a parameter that is random. The conditional pdf of <span class="math inline">\(X\)</span> given <span class="math inline">\(Y=y\)</span> is <span class="math inline">\(f_{X|Y=y}(x|y)=y e^{yx}\)</span> which is the exponential pdf with rate parameter <span class="math inline">\(\lambda\)</span> replaced by <span class="math inline">\(y\)</span>. The expected value is <span class="math inline">\(\frac1\lambda\)</span>, so in this case it is <span class="math inline">\(\frac1y\)</span>. This is NOT the expected value of <span class="math inline">\(X\)</span> though. This is the conditional expected value of <span class="math inline">\(X\)</span> given that <span class="math inline">\(Y=y\)</span>:
<span class="math display">\[E(X\mid Y=y)=\frac1y.\]</span>
And, in general, if we allow <span class="math inline">\(Y\)</span> to stay random, then we have
<span class="math display">\[E(X\mid Y)=\frac1Y\]</span>
which is still a random variable.</p>
<p>Using the total expectation formula, we get
<span class="math display">\[E(X)=E[E(X\mid Y)]=E\left[\frac1Y\right]=\int_1^5 \frac1y f_Y(y)~dy=\int_1^5 \frac1y \frac14~dy=\frac14\ln5.\]</span></p>
</div>
</div>
</div>
<div id="summary-2" class="section level2 unnumbered hasAnchor">
<h2>Summary<a href="conditional-expectation.html#summary-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="defbox">
<p><strong>Summary of notation, formulas, and terminology</strong></p>
<p><span class="math inline">\(E[X\mid Y]\)</span> is a random variable whose value is known once we know the value of <span class="math inline">\(Y\)</span>.</p>
<p><span class="math inline">\(E[X\mid Y=y]\)</span> is a real number, it is <span class="math inline">\(X\)</span> averaged according to the restriction that <span class="math inline">\(Y=y\)</span>.</p>
<p><span class="math inline">\(f_{X|Y=y}(x|y)=\frac{f_{X,Y}(x,y)}{f_Y(y)}\)</span> is the conditional probability function for <span class="math inline">\(X\)</span> given <span class="math inline">\(Y\)</span> (conditioned on <span class="math inline">\(Y\)</span>) where <span class="math inline">\(f_{X,Y}(x,y)\)</span> is the joint pf, and <span class="math inline">\(f_Y(y)\)</span> is the marginal pf for <span class="math inline">\(Y\)</span>. This works for both pmf and pdf.</p>
<p><span class="math inline">\(E[X\mid Y=y]=\sum_x x P(X=x\mid Y=y)=\sum_x x f_{X|Y=y}(x|y)\)</span> (discrete case)</p>
<p><span class="math inline">\(E[X\mid Y=y]=\int_{-\infty}^\infty x f_{X|Y=y}(x|y)\)</span> (continuous case)</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="random-variables-and-distributions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intro-stochastic-processes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jstover79/stochproc423/edit/master/04-cond-exp.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jstover79/stochproc423/blob/master/04-cond-exp.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
